<!DOCTYPE html>
<html lang="kor" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
>
<head layout:fragment="head">
    <meta charset="UTF-8">
    <title>MMMB</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
            integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
            crossorigin="anonymous"></script>
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
            background-color: #ffffff;
            color: #0c0c0c;
            font-size: 1rem;
        }

        #container {
            padding: 1rem 5rem;
        }

        footer {
            background-color: #eee;
            font-size: 0.8rem;
            padding: 3rem 3rem 6rem 3rem;
        }

        a {
            color: #0c0c0c;
            text-decoration: none;
        }

        a:hover {
            color: #0c0c0c;
            text-decoration: underline;
        }

        section {
            margin-top: 48px;
        }
    </style>
</head>
<body>
<header class="position-sticky top-0 bg-white" style="z-index: 1020;" layout:fragment="header">
    <div class="container py-4 position-relative">
        <!-- ëª¨ë°”ì¼ìš© í† ê¸€ ë²„íŠ¼ -->
        <div class="d-lg-none d-flex justify-content-between align-items-center">
            <a href="/">
                <img src="/images/logo_mini.png" alt="ë¡œê³ " style="height: 20px;">
            </a>
            <button class="btn border-0" type="button" data-bs-toggle="collapse" data-bs-target="#mobileNav"
                    aria-controls="mobileNav" aria-expanded="false" aria-label="Toggle navigation">
                <i class="bi bi-list fs-3"></i>
            </button>
        </div>

        <!-- ë°ìŠ¤í¬íƒ‘ ë©”ë‰´ -->
        <div class="d-none d-lg-flex justify-content-between align-items-center mb-1">
            <div class="d-flex align-items-center gap-3">
                <a href="/">
                    <img src="/images/logo_mini.png" alt="ë¡œê³ " style="height: 20px; margin-bottom: 2px;">
                </a>
                <a href="/" class="fw-bold">í´ë˜ìŠ¤</a>
                <a href="#" class="fw-bold">í´ëŸ½</a>
                <a href="#" class="fw-bold">ì»¤ë®¤ë‹ˆí‹°</a>
                <a href="#" class="fw-bold" id="categoryToggle">
                    ì¹´í…Œê³ ë¦¬ <i id="categoryIconDesktop" class="bi bi-caret-down-fill small"></i>
                </a>

                <div class="position-relative" style="width: 300px; margin-left: 10px;">
                    <input type="text" id="searchInputDesktop" class="form-control ps-3 pe-5"
                           placeholder="ê´€ì‹¬ ì£¼ì œ, í´ë˜ìŠ¤, í¬ë¦¬ì—ì´í„° ì°¾ê¸°"
                           style="height: 34px; font-size: 0.8rem; background-color: #F7F7F7; border: none;">
                    <i class="bi bi-search position-absolute top-50 end-0 translate-middle-y me-3 text-muted"
                       id="searchButtonDesktop"
                       style="font-size: 0.9rem; cursor: pointer;"></i>
                </div>
            </div>
            <div class="d-flex align-items-center gap-3">
                <th:block th:if="${session.loginId == null}">
                    <a href="/login" class="text-dark small fw-bold">ë¡œê·¸ì¸</a>
                    <a href="/signup" class="text-dark small fw-bold">íšŒì›ê°€ì…</a>
                </th:block>
                <th:block th:unless="${session.loginId == null}">
                    <th:block th:if="${session.loginId == 'master'}">
                        <a href="/admin/chat"
                           class="btn btn-link text-dark p-0 m-0 position-relative"
                           style="text-decoration: none;">
                            <i class="bi bi-chat-dots fs-4"></i>
                            <span th:if="${hasUnread == true}"
                                  class="position-absolute start-100 translate-middle bg-danger border border-light rounded-circle"
                                  style="width: 12px; height: 12px; font-size: 0.5rem; top: -3px; right: -3px;">
            <span class="visually-hidden">New alerts</span>
        </span>
                        </a>
                    </th:block>
                    <a href="/mypage_wishlist" class="text-dark small fw-bold">ë§ˆì´í˜ì´ì§€</a>
                    <a href="/logout" class="text-dark small fw-bold">ë¡œê·¸ì•„ì›ƒ</a>
                </th:block>
            </div>

            <div id="categoryMenu" class="border p-4 bg-white shadow position-absolute w-100"
                 style="top: 100%; left: 0; display: none; z-index: 1040;">
                <div class="row row-cols-2 row-cols-md-4">
                    <div>
                        <p><a th:href="@{/class/category/1}" class="text-dark text-decoration-none">ë””ì§€í„¸ ë“œë¡œì‰</a></p>
                        <p><a th:href="@{/class/category/2}" class="text-dark text-decoration-none">ë“œë¡œì‰</a></p>
                        <p><a th:href="@{/class/category/3}" class="text-dark text-decoration-none">ê³µì˜ˆ</a></p>
                        <p><a th:href="@{/class/category/4}" class="text-dark text-decoration-none">ìš”ë¦¬ Â· ìŒë£Œ</a></p>
                        <p><a th:href="@{/class/category/5}" class="text-dark text-decoration-none">ë² ì´í‚¹ Â· ë””ì €íŠ¸</a></p>
                        <p><a th:href="@{/class/category/6}" class="text-dark text-decoration-none">ìŒì•…</a></p>
                        <p><a th:href="@{/class/category/7}" class="text-dark text-decoration-none">ìš´ë™</a></p>
                        <p><a th:href="@{/class/category/8}" class="text-dark text-decoration-none">ë¼ì´í”„ìŠ¤íƒ€ì¼</a></p>
                        <p><a th:href="@{/class/category/9}" class="text-dark text-decoration-none">ì‚¬ì§„ Â· ì˜ìƒ</a></p>
                    </div>
                    <div>
                        <p><a th:href="@{/class/category/10}" class="text-dark text-decoration-none">ê¸ˆìœµ Â· ì¬í…Œí¬</a></p>
                        <p><a th:href="@{/class/category/11}" class="text-dark text-decoration-none">ì°½ì—… Â· ë¶€ì—…</a></p>
                        <p><a th:href="@{/class/category/12}" class="text-dark text-decoration-none">ì„±ê³µ ë§ˆì¸ë“œ</a></p>
                        <p><a th:href="@{/class/category/13}" class="text-dark text-decoration-none">í”„ë¡œê·¸ë˜ë°</a></p>
                        <p><a th:href="@{/class/category/14}" class="text-dark text-decoration-none">ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤</a></p>
                        <p><a th:href="@{/class/category/15}" class="text-dark text-decoration-none">ì œí’ˆ ê¸°íš</a></p>
                        <p><a th:href="@{/class/category/16}" class="text-dark text-decoration-none">ë¹„ì¦ˆë‹ˆìŠ¤</a></p>
                        <p><a th:href="@{/class/category/17}" class="text-dark text-decoration-none">ìƒì‚°ì„±</a></p>
                        <p><a th:href="@{/class/category/18}" class="text-dark text-decoration-none">ë§ˆì¼€íŒ…</a></p>
                    </div>
                    <div>
                        <p><a th:href="@{/class/category/19}" class="text-dark text-decoration-none">ë””ìì¸</a></p>
                        <p><a th:href="@{/class/category/20}" class="text-dark text-decoration-none">ì˜ìƒ/3D</a></p>
                        <p><a th:href="@{/class/category/21}" class="text-dark text-decoration-none">ì˜ì–´</a></p>
                        <p><a th:href="@{/class/category/22}" class="text-dark text-decoration-none">ì™¸êµ­ì–´ ì‹œí—˜</a></p>
                        <p><a th:href="@{/class/category/23}" class="text-dark text-decoration-none">ì œ2 ì™¸êµ­ì–´</a></p>
                    </div>
                    <div>
                        <p><a th:href="@{/class/category/24}" class="text-dark text-decoration-none">ì•„ì´ êµìœ¡</a></p>
                        <p><a th:href="@{/class/category/25}" class="text-dark text-decoration-none">ë¶€ëª¨ êµìœ¡</a></p>
                    </div>
                </div>
                <div class="text-end mt-3">
                    <button class="btn btn-sm border-0 small" onclick="toggleCategoryMenu()"
                            style="font-size: 0.75rem;">
                        âœ• ë‹«ê¸°
                    </button>
                </div>
            </div>
        </div>
        <!-- ëª¨ë°”ì¼ ë©”ë‰´ -->
        <div class="collapse d-lg-none mt-2" id="mobileNav">
            <div class="d-flex flex-column gap-2">
                <a href="/" class="fw-bold">í´ë˜ìŠ¤</a>
                <a href="#" class="fw-bold">í´ëŸ½</a>
                <a href="#" class="fw-bold">ì»¤ë®¤ë‹ˆí‹°</a>
                <a href="#" class="fw-bold" id="mobileCategoryToggle">
                    ì¹´í…Œê³ ë¦¬ <i id="categoryIconMobile" class="bi bi-caret-down-fill small"></i>
                </a>
                <div id="mobileCategoryMenu" class="bg-white p-3 border mt-2">
                    <div class="row row-cols-2">
                        <div>
                            <p><a th:href="@{/class/category/1}" class="text-dark text-decoration-none">ë””ì§€í„¸ ë“œë¡œì‰</a>
                            </p>
                            <p><a th:href="@{/class/category/2}" class="text-dark text-decoration-none">ë“œë¡œì‰</a></p>
                            <p><a th:href="@{/class/category/3}" class="text-dark text-decoration-none">ê³µì˜ˆ</a></p>
                            <p><a th:href="@{/class/category/4}" class="text-dark text-decoration-none">ìš”ë¦¬ Â· ìŒë£Œ</a>
                            </p>
                            <p><a th:href="@{/class/category/5}" class="text-dark text-decoration-none">ë² ì´í‚¹ Â·
                                ë””ì €íŠ¸</a>
                            </p>
                            <p><a th:href="@{/class/category/6}" class="text-dark text-decoration-none">ìŒì•…</a></p>
                            <p><a th:href="@{/class/category/7}" class="text-dark text-decoration-none">ìš´ë™</a></p>
                            <p><a th:href="@{/class/category/8}" class="text-dark text-decoration-none">ë¼ì´í”„ìŠ¤íƒ€ì¼</a>
                            </p>
                            <p><a th:href="@{/class/category/9}" class="text-dark text-decoration-none">ì‚¬ì§„ Â· ì˜ìƒ</a>
                            </p>
                        </div>
                        <div>
                            <p><a th:href="@{/class/category/10}" class="text-dark text-decoration-none">ê¸ˆìœµ Â·
                                ì¬í…Œí¬</a>
                            </p>
                            <p><a th:href="@{/class/category/11}" class="text-dark text-decoration-none">ì°½ì—… Â· ë¶€ì—…</a>
                            </p>
                            <p><a th:href="@{/class/category/12}" class="text-dark text-decoration-none">ì„±ê³µ ë§ˆì¸ë“œ</a>
                            </p>
                            <p><a th:href="@{/class/category/13}" class="text-dark text-decoration-none">í”„ë¡œê·¸ë˜ë°</a>
                            </p>
                            <p><a th:href="@{/class/category/14}" class="text-dark text-decoration-none">ë°ì´í„°ì‚¬ì´ì–¸ìŠ¤</a>
                            </p>
                            <p><a th:href="@{/class/category/15}" class="text-dark text-decoration-none">ì œí’ˆ ê¸°íš</a>
                            </p>
                            <p><a th:href="@{/class/category/16}" class="text-dark text-decoration-none">ë¹„ì¦ˆë‹ˆìŠ¤</a>
                            </p>
                            <p><a th:href="@{/class/category/17}" class="text-dark text-decoration-none">ìƒì‚°ì„±</a></p>
                            <p><a th:href="@{/class/category/18}" class="text-dark text-decoration-none">ë§ˆì¼€íŒ…</a></p>
                        </div>
                        <div>
                            <p><a th:href="@{/class/category/19}" class="text-dark text-decoration-none">ë””ìì¸</a></p>
                            <p><a th:href="@{/class/category/20}" class="text-dark text-decoration-none">ì˜ìƒ/3D</a>
                            </p>
                            <p><a th:href="@{/class/category/21}" class="text-dark text-decoration-none">ì˜ì–´</a></p>
                            <p><a th:href="@{/class/category/22}" class="text-dark text-decoration-none">ì™¸êµ­ì–´ ì‹œí—˜</a>
                            </p>
                            <p><a th:href="@{/class/category/23}" class="text-dark text-decoration-none">ì œ2 ì™¸êµ­ì–´</a>
                            </p>
                        </div>
                        <div>
                            <p><a th:href="@{/class/category/24}" class="text-dark text-decoration-none">ì•„ì´ êµìœ¡</a>
                            </p>
                            <p><a th:href="@{/class/category/25}" class="text-dark text-decoration-none">ë¶€ëª¨ êµìœ¡</a>
                            </p>
                        </div>
                    </div>
                    <div class="text-end mt-3">
                        <button class="btn btn-sm border-0 small" onclick="toggleCategoryMenu()"
                                style="font-size: 0.75rem;">
                            âœ• ë‹«ê¸°
                        </button>
                    </div>
                </div>

                <!-- ëª¨ë°”ì¼ ê²€ìƒ‰ì°½ -->
                <div class="position-relative mb-3">
                    <input type="text" id="searchInputMobile" class="form-control ps-3 pe-5"
                           placeholder="ê´€ì‹¬ ì£¼ì œ, í´ë˜ìŠ¤, í¬ë¦¬ì—ì´í„° ì°¾ê¸°"
                           style="height: 34px; font-size: 0.8rem; background-color: #F7F7F7; border: none;">
                    <i class="bi bi-search position-absolute top-50 end-0 translate-middle-y me-3 text-muted"
                       id="searchButtonMobile"
                       style="font-size: 0.9rem; cursor: pointer;"></i>
                </div>

                <div th:if="${userInfo == null}">
                    <a href="/login" class="text-dark small fw-bold">ë¡œê·¸ì¸</a> |
                    <a href="/signup" class="text-dark small fw-bold">íšŒì›ê°€ì…</a>
                </div>
                <div th:unless="${userInfo == null}">
                    <a href="/mypage_wishlist" class="text-dark small fw-bold">ë§ˆì´í˜ì´ì§€</a> |
                    <a href="/logout" class="text-dark small fw-bold">ë¡œê·¸ì•„ì›ƒ</a>
                </div>
            </div>
        </div>
    </div>
</header>

<div layout:fragment="content">
    <p>ì»¨í…ì¸ </p>
</div>
<!--<footer layout:fragment="footer" class="w-100" style="background-color: #eee;">-->
<!--    <div class="row">-->
<!--        <div class="col-md-4">-->
<!--            <h6 class="fw-bold">ê³ ê°ì„¼í„°</h6>-->
<!--            <p>support@class101.net</p>-->
<!--        </div>-->
<!--        <div class="col-md-4">-->
<!--            <h6 class="fw-bold">íšŒì‚¬ ì •ë³´</h6>-->
<!--            <p>ì„œìš¸íŠ¹ë³„ì‹œ ì„±ë™êµ¬ ì™•ì‹­ë¦¬ë¡œ 125</p>-->
<!--        </div>-->
<!--        <div class="col-md-4">-->
<!--            <h6 class="fw-bold">ì•± ë‹¤ìš´ë¡œë“œ</h6>-->
<!--            <a href="#">App Store</a> | <a href="#">Google Play</a>-->
<!--        </div>-->
<!--    </div>-->
<!--    <p class="text-center text-muted small mt-4">Â© 2025 CLASS101 í´ë¡ </p>-->
<!--</footer>-->
<footer layout:fragment="footer" class="w-100 border-top" style="background-color: #f8f9fa;">
    <div class="container py-5">
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">
            <div>
                <img src="/images/logo_mini.png" alt="ë¡œê³ " style="height: 24px;">
                <p class="mt-3 mb-1 text-muted small">MMMB</p>
                <p class="mb-0 text-muted small">ì„œìš¸íŠ¹ë³„ì‹œ ì„±ë™êµ¬ ì™•ì‹­ë¦¬ë¡œ 125</p>
                <p class="mb-0 text-muted small">ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 123-45-67890</p>
                <p class="mb-0 text-muted small">ëŒ€í‘œ: ë°•ì§„ìš°</p>
            </div>
            <div>
                <h6 class="fw-bold mb-3">ê³ ê°ì„¼í„°</h6>
                <p class="mb-1 text-muted small">support@class101.net</p>
                <p class="mb-1 text-muted small">í‰ì¼ 10:00~18:00 (ì ì‹¬ 13:00~14:00)</p>
                <a href="/chat" class="text-dark small">1:1 ë¬¸ì˜</a>
            </div>
            <div>
                <h6 class="fw-bold mb-3">ì´ìš©ì•ˆë‚´</h6>
                <ul class="list-unstyled mb-0">
                    <li><a href="#" class="text-dark small">ì´ìš©ì•½ê´€</a></li>
                    <li><a href="#" class="text-dark small">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
                    <li><a href="#" class="text-dark small">í™˜ë¶ˆì •ì±…</a></li>
                    <li><a href="#" class="text-dark small">ê³µì§€ì‚¬í•­</a></li>
                </ul>
            </div>
            <div>
                <h6 class="fw-bold mb-3">SNS</h6>
                <a href="#" class="me-2 text-dark"><i class="bi bi-instagram fs-4"></i></a>
                <a href="#" class="me-2 text-dark"><i class="bi bi-youtube fs-4"></i></a>
                <a href="#" class="me-2 text-dark"><i class="bi bi-facebook fs-4"></i></a>
                <a href="#" class="text-dark"><i class="bi bi-twitter fs-4"></i></a>
                <div class="mt-3">
                    <a href="#" class="btn btn-outline-secondary btn-sm me-2">App Store</a>
                    <a href="#" class="btn btn-outline-secondary btn-sm">Google Play</a>
                </div>
            </div>
        </div>
        <div class="text-center text-muted small mt-4 pt-3 border-top">
            Â© 2025 CLASS101 í´ë¡  | All rights reserved.<br>
        </div>
    </div>
</footer>

<!-- ì±„íŒ… ì—´ê¸° ë²„íŠ¼ (í™”ë©´ ìš°í•˜ë‹¨ ê³ ì •) -->
<div id="chat-toggle-button"
     class="position-fixed"
     style="bottom: 100px; right: 20px; z-index: 1050; cursor: pointer;">
    <div class="btn btn-light rounded-circle d-flex justify-content-center align-items-center"
         style="width: 56px; height: 56px; padding: 0;">
        <i class="bi bi-chat-dots fs-4 text-dark"></i>
        <span th:if="${hasUnread == true}"
              id="chatAlertBadge"
              class="position-absolute translate-middle p-1 bg-danger rounded-circle"
              style="width: 10px; height: 10px; font-size: 0.3rem; top: 19px; left: 38px;">
            <span class="visually-hidden">New alerts</span>
        </span>
    </div>
</div>

<!-- ì±„íŒ… íŒì—…ì°½ (iframe) -->
<div id="floating-chatbox"
     class="position-fixed bottom-0 end-0 m-4 shadow bg-white"
     style="width: 350px; height: 500px; display: none; border-radius: 12px; z-index: 1051;">
    <div class="d-flex justify-content-between align-items-center px-3 py-2 border-bottom bg-dark text-white rounded-top">
        <strong>ê³ ê°ì„¼í„°</strong>
        <button id="close-chatbox" class="btn btn-sm btn-light">&times;</button>
    </div>

    <iframe id="chat-iframe"
            src=""
            style="width: 100%; height: 92%; border: none; border-radius: 0 0 12px 12px;"></iframe>
</div>

<!-- ì±„íŒ… í† ê¸€ ìŠ¤í¬ë¦½íŠ¸ -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const toggleBtn = document.getElementById("chat-toggle-button");
        const chatBox = document.getElementById("floating-chatbox");
        const closeBtn = document.getElementById("close-chatbox");

        toggleBtn?.addEventListener("click", () => {
            const iframe = document.getElementById("chat-iframe");
            const isMaster = /*[[${session.loginId == 'master'}]]*/ false;
            iframe.src = isMaster ? '/admin/chat' : '/chat';

            chatBox.style.display = "block";
            toggleBtn.style.display = "none";
        });


        closeBtn?.addEventListener("click", () => {
            chatBox.style.display = "none";
            toggleBtn.style.display = "block";

            // ë‹«ì„ ë•Œ ì½ìŒ ì—¬ë¶€ í™•ì¸í•´ì„œ ë±ƒì§€ ì œê±°
            fetch("/api/chat/unread")
                .then(res => res.json())
                .then(hasUnread => {
                    if (!hasUnread) {
                        const badge = document.getElementById("chatAlertBadge");
                        if (badge) badge.remove(); // ë°°ì§€ ì œê±°
                    }
                });
        });
    });
</script>

<th:block layout:fragment="script">
    <script>
        // const successMsg = [[${success}]];
        // if (successMsg !== null) {
        //     alert(successMsg);
        // }
    </script>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const inputs = [
                document.getElementById("searchInputDesktop"),
                document.getElementById("searchInputMobile")
            ];
            const buttons = [
                document.getElementById("searchButtonDesktop"),
                document.getElementById("searchButtonMobile")
            ];

            inputs.forEach((input) => {
                if (!input) return;
                input.addEventListener("keypress", function (e) {
                    if (e.key === "Enter") {
                        const keyword = input.value.trim();
                        if (!keyword) return;
                        location.href = `/class/search?q=${encodeURIComponent(keyword)}`;
                    }
                });
            });

            buttons.forEach((btn, index) => {
                const input = inputs[index];
                if (!btn || !input) return;

                btn.addEventListener("click", function () {
                    console.log("ğŸ” ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ë¨");
                    const keyword = input.value.trim();
                    if (!keyword) return;
                    location.href = `/class/search?q=${encodeURIComponent(keyword)}`;
                });
            });
        });

    </script>

    <script>
        window.addEventListener('message', function (event) {
            if (event.data && event.data.type === 'TOGGLE_CATEGORY_MENU') {
                const isMobile = window.innerWidth < 992;

                if (isMobile) {
                    const mobileNav = document.getElementById('mobileNav');
                    const menu = document.getElementById('mobileCategoryMenu');
                    const icon = document.getElementById('categoryIconMobile');
                    if (!menu || !icon || !mobileNav) return;

                    if (!mobileNav.classList.contains('show')) {
                        const bsCollapse = bootstrap.Collapse.getOrCreateInstance(mobileNav);
                        bsCollapse.show();
                    }

                    const isOpen = !menu.classList.contains('d-none');
                    menu.classList.toggle('d-none');
                    icon.classList.toggle('bi-caret-up-fill', !isOpen);
                    icon.classList.toggle('bi-caret-down-fill', isOpen);
                } else {
                    const menu = document.getElementById('categoryMenu');
                    const icon = document.getElementById('categoryIconDesktop');
                    if (!menu || !icon) return;

                    const isOpen = menu.style.display === 'block';
                    menu.style.display = isOpen ? 'none' : 'block';
                    icon.classList.toggle('bi-caret-up-fill', !isOpen);
                    icon.classList.toggle('bi-caret-down-fill', isOpen);
                }
            }
        });
    </script>

    <script>
        function toggleCategoryMenu() {
            const isMobile = window.innerWidth < 992;

            if (isMobile) {
                const mobileNav = document.getElementById('mobileNav');
                const menu = document.getElementById('mobileCategoryMenu');
                const icon = document.getElementById('categoryIconMobile');
                if (!menu || !icon || !mobileNav) return;

                // Bootstrap collapse ì˜ì—­ ì—´ê¸° ê°•ì œ (ê¶Œì¥ ë°©ì‹)
                if (!mobileNav.classList.contains('show')) {
                    const bsCollapse = bootstrap.Collapse.getOrCreateInstance(mobileNav);
                    bsCollapse.show();
                }

                const isOpen = !menu.classList.contains('d-none');
                menu.classList.toggle('d-none');
                icon.classList.toggle('bi-caret-up-fill', !isOpen);
                icon.classList.toggle('bi-caret-down-fill', isOpen);
            } else {
                const menu = document.getElementById('categoryMenu');
                const icon = document.getElementById('categoryIconDesktop');
                if (!menu || !icon) return;

                const isOpen = menu.style.display === 'block';
                menu.style.display = isOpen ? 'none' : 'block';
                icon.classList.toggle('bi-caret-up-fill', !isOpen);
                icon.classList.toggle('bi-caret-down-fill', isOpen);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const desktopToggle = document.getElementById('categoryToggle');
            const mobileToggle = document.getElementById('mobileCategoryToggle');

            if (desktopToggle) {
                desktopToggle.addEventListener('click', function (e) {
                    e.preventDefault();
                    toggleCategoryMenu();
                });
            }

            if (mobileToggle) {
                mobileToggle.addEventListener('click', function (e) {
                    e.preventDefault();
                    toggleCategoryMenu();
                });
            }
        });

        document.addEventListener('click', function (e) {
            const isMobile = window.innerWidth < 992;

            if (isMobile) {
                const toggle = document.getElementById('mobileCategoryToggle');
                const menu = document.getElementById('mobileCategoryMenu');
                const icon = document.getElementById('categoryIconMobile');
                if (!toggle || !menu || !icon) return;

                if (!toggle.contains(e.target) && !menu.contains(e.target)) {
                    menu.classList.add('d-none');
                    icon.classList.remove('bi-caret-up-fill');
                    icon.classList.add('bi-caret-down-fill');
                }
            } else {
                const toggle = document.getElementById('categoryToggle');
                const menu = document.getElementById('categoryMenu');
                const icon = document.getElementById('categoryIconDesktop');
                if (!toggle || !menu || !icon) return;

                if (!toggle.contains(e.target) && !menu.contains(e.target)) {
                    menu.style.display = 'none';
                    icon.classList.remove('bi-caret-up-fill');
                    icon.classList.add('bi-caret-down-fill');
                }
            }
        });
    </script>

</th:block>
</body>
</html>